#API для интернет-магазина подарков
Интернет-магазин подарков хочет запустить акцию в разных регионах. 
Чтобы стратегия продаж была эффективной, необходимо произвести 
анализ рынка.

У магазина есть поставщик, регулярно присылающий выгрузки 
данных с информацией о жителях. Проанализировав их, 
можно выявить спрос на подарки в разных городах у 
жителей разных возрастных групп по месяцам.

Проект - python REST API сервис, который сохраняет переданные 
ему наборы данных (выгрузки от поставщика) c жителями, 
позволяет их просматривать, редактировать информацию об 
отдельных жителях, а также производить анализ возрастов жителей 
по городам и анализировать спрос на подарки в разных 
месяцах для указанного набора данных.

##Обработчики
###1: POST /imports
Принимает на вход набор с данными о жителях в формате json 
и сохраняет его с уникальным идентификатором `import_id`.

В случае невалидных данных возвращает ошибку 400.

В случае успеха возвращается ответ с HTTP статусом 201 

###2: PATCH /imports/$import_id/citizens/$citizen_id
Принимает на вход JSON в котором можно указать любые допустимые 
данные о жителе, кроме `citizen_id` и изменяет информацию о 
жителе в указанном наборе данных. 

В случае невалидных данных возвращает ошибку 400.
В случае успеха возвращает актуальная информация об указанном 
жителе и HTTP код 200.

###3: GET /imports/$import_id/citizens
Возвращает список всех жителей для указанного `import_id` и HTTP код 200.

###4: GET /imports/$import_id/citizens/birthdays
Возвращает жителей и количество подарков, которые они будут 
покупать своим ближайшим родственникам, 
сгруппированных по месяцам из указанного набора данных, и HTTP код 200.

###5: GET /imports/$import_id/towns/stat/percentile/age
Возвращает статистику по городам для указанного набора 
данных в разрезе возраста (полных лет) жителей: 
p50, p75, p99, где число - это значение перцентиля.

## Установка и запуск проекта
Скачаем проект, установим зависимости:
```
git clone https://github.com/Sonichka1311/backend_school_task.git
cd backend_school_task
pip3 install virtualenv
python3 -m venv env
source env/bin/activate
pip3 install -r requirements.txt
```

Зависимости находятся в requirements.txt.

Запускаем скрипт создание датабазы (только один раз, при деплое):
```
python3 setUp.py
```
Запускаем проект:
```
python3 run.py
```

Сервер будет запущен на ```0.0.0.0:8080```

### Запуск проекта в режиме демона
Установим зависимости и запустим проект с конфигом:
```
sudo apt install nodejs
sudo apt install npm
sudo npm i -g pm2
pm2 start ecosystem.config.js
```

### Запуск тестов
```
python3 ut.py
```
